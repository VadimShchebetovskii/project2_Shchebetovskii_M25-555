Проект представляет собой систему для управления валютным портфелем, включающую работу с внешними API, кеширование данных и CLI-интерфейс. Ниже описана структура проекта и основные компоненты.

## Структура проекта

```
finalproject_Shchebetovskii_M25-555/
│  
├── data/                         # Каталог с данными и кэшем
│    ├── users.json               # Данные пользователей
│    ├── portfolios.json          # Портфели пользователей
│    ├── rates.json               # Локальный кэш для Core Service (текущие курсы)
│    ├── exchange_rates.json      # Исторические данные от Parser Service
│    └── logs/                    # Каталог с логами
│         └── actions.log         # Логи
│
├── valutatrade_hub/              # Основной модуль системы
│    ├── __init__.py
│    ├── logging_config.py        # Конфигурация логирования
│    ├── decorators.py            # Декораторы
│    ├── core/                    # Бизнес-логика и модели
│    │    ├── __init__.py
│    │    ├── constants.py        # Константы
│    │    ├── currencies.py       # Работа с валютами
│    │    ├── exceptions.py       # Исключения проекта
│    │    ├── models.py           # Модели данных
│    │    ├── usecases.py         # Основные сценарии использования
│    │    └── utils.py            # Вспомогательные функции
│    ├── infra/                   # Инфраструктура и настройки
│    │    ├─ __init__.py
│    │    ├── settings.py         # Настройки проекта
│    │    └── database.py         # Работа с базой данных или файлами
│    ├── parser_service/          # Модуль парсинга и обновления курсов
│    │    ├── __init__.py
│    │    ├── config.py           # Конфигурация API и обновлений
│    │    ├── api_clients.py      # Работа с внешними API
│    │    ├── updater.py          # Основной модуль обновления курсов
│    │    ├── storage.py          # Чтение/запись exchange_rates.json
│    │    └── scheduler.py        # Планировщик периодического обновления
│    └── cli/                     # CLI интерфейс
│         ├─ __init__.py
│         └─ interface.py         # Реализация командной строки
│
├── config.json                   # Конфигурация системы
├── main.py                       # Точка входа в программу
├── Makefile                      # Makefile для автоматизации задач
├── poetry.lock                   # Lock-файл Poetry
├── pyproject.toml                # Конфигурация Poetry / Poetry dependencies
├── README.md                     # Этот файл
└── .gitignore                    # Исключения Git
```

## Описание компонентов

- **data/** — директория с исходными данными, локальными кэшами и историческими курсами.
- **valutatrade_hub/** — основной код системы, разделённый на логическую и инфраструктурную части.
- **parser_service/** — модуль для получения и обновления валютных курсов из внешних источников.
- **cli/** — командный интерфейс для взаимодействия с пользователем.
- **main.py** — запуск системы, запуск CLI или автоматических обновлений.

## Начало работы

1. Установите зависимости, например, с помощью Poetry:

```bash
poetry install
```

2. Настройте Parser Service, настройте конфигурации по необходимости в `config.json`.

3. Запустите программу:

```bash
poetry run project
```

или

```bash
python main.py
```

## Настройка Parser Service

- Получите API ключ на exchangerate-api.com.
- Установите переменную окружения `EXCHANGERATE_API_KEY` в системе.

## Примеры команд CLI

1. Регистрация и вход в систему

- register --username alice --password 1234
- login --username alice --password 1234

2. Управление портфелем

- show-portfolio --base EUR
- buy --currency RUB --amount 100
- sell --currency BTC --amount 0.005

3. Работа с курсами

- get-rate --from USD --to BTC
- update-rates
- show-rates --top 3

## Кэш и TTL

- Система использует двухуровневое кэширование.
- `rates.json` - быстрый кэш для Core Service.
- TTL (Time To Live): 5 минут по умолчанию.
- При запросе курса проверяется свежесть данных.
- Если данные устарели, запускается обновление через Parser Service.

## Дополнительная информация

- USD - базовая валюта
- Поддерживаются фиатные и криптовалюты
- После старта приложения рекомендуется обновить курсы, чтобы они закэшировались.
- Исторические данные о курсах хранятся в `exchange_rates.json`.

## Контакты

Автор: Shchebetovskii V.A.

Группа: M25-555